ìŠ¤ë§ˆíŠ¸ì‹±ì¦ˆ Acceptance API ì—°ë™ì„ ìœ„í•´ **Ktor**ë¥¼ ì‚¬ìš©í•œ ì•ˆë“œë¡œì´ë“œ êµ¬í˜„ ë°©ë²•ì„ ì•ˆë‚´í•´ ë“œë¦½ë‹ˆë‹¤. KtorëŠ” ì½”í‹€ë¦° ì¹œí™”ì ì´ë©° ë¹„ë™ê¸° ì²˜ë¦¬ì— ë§¤ìš° ê°•ë ¥í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ì…ë‹ˆë‹¤.

---

## 1. í”„ë¡œì íŠ¸ ì„¤ì • (build.gradle.kts)

ì•ˆë“œë¡œì´ë“œ ìŠ¤íŠœë””ì˜¤ì˜ `build.gradle.kts (Module :app)` íŒŒì¼ì— Ktor ê´€ë ¨ ì˜ì¡´ì„±ì„ ì¶”ê°€í•©ë‹ˆë‹¤.

```kotlin
dependencies {
    val ktorVersion = "2.3.7"
    implementation("io.ktor:ktor-client-core:$ktorVersion")
    implementation("io.ktor:ktor-client-android:$ktorVersion")
    implementation("io.ktor:ktor-client-content-negotiation:$ktorVersion")
    implementation("io.ktor:ktor-serialization-kotlinx-json:$ktorVersion")
    implementation("io.ktor:ktor-client-logging:$ktorVersion")
    
    // Coroutines
    implementation("org.jetbrains.kotlinx:kotlinx-coroutines-android:1.7.3")
}

```

**AndroidManifest.xml**ì— ì¸í„°ë„· ê¶Œí•œì„ ë°˜ë“œì‹œ ì¶”ê°€í•˜ì„¸ìš”.

```xml
<uses-permission android:name="android.permission.INTERNET" />

```

---

## 2. Ktor í´ë¼ì´ì–¸íŠ¸ ë° í˜¸ì¶œ ì½”ë“œ êµ¬í˜„

KtorëŠ” `HttpClient` ê°ì²´ë¥¼ í†µí•´ í†µì‹ í•©ë‹ˆë‹¤. JSON ì§ë ¬í™”ë¥¼ ìœ„í•´ `kotlinx.serialization`ì„ í•¨ê»˜ ì‚¬ìš©í•©ë‹ˆë‹¤.

```kotlin
import io.ktor.client.*
import io.ktor.client.engine.android.*
import io.ktor.client.plugins.contentnegotiation.*
import io.ktor.client.request.*
import io.ktor.client.statement.*
import io.ktor.http.*
import io.ktor.serialization.kotlinx.json.*
import kotlinx.serialization.Serializable
import kotlinx.serialization.json.Json

// 1. ìš”ì²­ ë°ì´í„° ëª¨ë¸ ì •ì˜
@Serializable
data class ActivitySearchRequest(
    val location: String,
    val include: List<String>
)

class SmartThingsManager {
    // 2. Ktor í´ë¼ì´ì–¸íŠ¸ ì„¤ì •
    private val client = HttpClient(Android) {
        install(ContentNegotiation) {
            json(Json {
                ignoreUnknownKeys = true
                prettyPrint = true
            })
        }
    }

    suspend fun searchActivities(): String {
        return try {
            val response: HttpResponse = client.post("https://api.stacceptance.com/activities/search") {
                // Query Parameter
                parameter("limit", 20)
                
                // Headers
                header(HttpHeaders.Authorization, "Bearer xxxxxxx")
                contentType(ContentType.Application.Json)
                header(HttpHeaders.Accept, "application/json") // jjson ì˜¤íƒ€ ìˆ˜ì •

                // Body
                setBody(ActivitySearchRequest(
                    location = "xxxx",
                    include = listOf("execution")
                ))
            }

            if (response.status == HttpStatusCode.OK) {
                response.bodyAsText()
            } else {
                "Error: ${response.status}"
            }
        } catch (e: Exception) {
            "Failure: ${e.message}"
        } finally {
            // ì§€ì†ì ìœ¼ë¡œ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ client.close()ë¥¼ ê³ ë ¤í•˜ì„¸ìš”.
        }
    }
}

```

---

## 3. ì•±(App)ìœ¼ë¡œ ë§Œë“œëŠ” ë°©ë²• (UI ì—°ê²°)

ì•ˆë“œë¡œì´ë“œ ìŠ¤íŠœë””ì˜¤ì—ì„œ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ APIë¥¼ í˜¸ì¶œí•˜ê³  ê²°ê³¼ë¥¼ í…ìŠ¤íŠ¸ë·°ì— ë³´ì—¬ì£¼ëŠ” ê°„ë‹¨í•œ êµ¬ì¡°ì…ë‹ˆë‹¤.

### Layout (activity_main.xml)

```xml
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    android:padding="16dp">

    <Button
        android:id="@+id/btnFetch"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="API í˜¸ì¶œí•˜ê¸°" />

    <TextView
        android:id="@+id/tvResult"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_marginTop="20dp"
        android:text="ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤." />
</LinearLayout>

```

### Activity (MainActivity.kt)

```kotlin
import android.os.Bundle
import android.widget.Button
import android.widget.TextView
import androidx.appcompat.app.AppCompatActivity
import androidx.lifecycle.lifecycleScope
import kotlinx.coroutines.launch

class MainActivity : AppCompatActivity() {
    private val apiManager = SmartThingsManager()

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)

        val btnFetch = findViewById<Button>(R.id.btnFetch)
        val tvResult = findViewById<TextView>(R.id.tvResult)

        btnFetch.setOnClickListener {
            // ì½”ë£¨í‹´ ìŠ¤ì½”í”„ì—ì„œ API ì‹¤í–‰
            lifecycleScope.launch {
                tvResult.text = "ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."
                val result = apiManager.searchActivities()
                tvResult.text = result
            }
        }
    }
}

```

---

## ğŸš€ ì•± ì‹¤í–‰ ë‹¨ê³„

1. **Android Studio**ë¥¼ ì—´ê³  'Empty Views Activity' í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
2. ìœ„ ì½”ë“œë“¤ì„ ê°ê°ì˜ íŒŒì¼ ìœ„ì¹˜ì— ë³µì‚¬í•©ë‹ˆë‹¤.
3. `Bearer xxxxxxx`ì™€ `location` ê°’ì„ ì‹¤ì œ ë³¸ì¸ì˜ API í‚¤ì™€ ê°’ìœ¼ë¡œ ìˆ˜ì •í•©ë‹ˆë‹¤.
4. ìƒë‹¨ **'Run' (ë…¹ìƒ‰ í™”ì‚´í‘œ)** ë²„íŠ¼ì„ ëˆŒëŸ¬ ì—ë®¬ë ˆì´í„°ë‚˜ ì‹¤ì œ ê¸°ê¸°ì—ì„œ ì‹¤í–‰í•©ë‹ˆë‹¤.

í˜¹ì‹œ API ì‘ë‹µ ë°ì´í„°(JSON)ë¥¼ íŒŒì‹±í•´ì„œ íŠ¹ì • ê°’(ì˜ˆ: ì¥ì¹˜ ì´ë¦„)ë§Œ ë¦¬ìŠ¤íŠ¸ë¡œ ë½‘ì•„ í™”ë©´ì— ê·¸ë¦¬ê¸¸ ì›í•˜ì‹œë‚˜ìš”? ì›í•˜ì‹œë©´ ê·¸ ë¶€ë¶„ë„ ì½”ë“œë¥¼ ì§œë“œë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
